!function(t){var e={};function n(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(s,r,function(e){return t[e]}.bind(null,r));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t){t.exports=JSON.parse('{"idle":{"right":[{"ms":[1000,4000],"random":true,"cells":[[null,"b","b"],["|","_","|"],["!",null,"!"]]},{"ms":500,"cells":[[null,"d","d"],["|","_","|"],["!",null,"!"]]},{"ms":500,"cells":[[null,"L","L"],["|","_","|"],["!",null,"!"]]},{"ms":2500,"cells":[[null,"b","b"],["<","_","|"],["!",null,"!"]]},{"ms":2500,"cells":[[null,"b","b"],["|","_",">"],["!",null,"!"]]}],"left":[{"ms":8000,"cells":[["d","d",null],["|","_","|"],["!",null,"!"]]},{"ms":500,"cells":[["d","d",null],["|","_","|"],["!",null,"!"]]},{"ms":500,"cells":[["L","L",null],["|","_","|"],["!",null,"!"]]},{"ms":2500,"cells":[["d","d",null],["<","_","|"],["!",null,"!"]]},{"ms":2500,"cells":[["b","b",null],["|","_",">"],["!",null,"!"]]}]},"move":{"left":[{"ms":200,"cells":[["d","d",null],["|","_","|"],["\'",null,"!"]]},{"ms":200,"cells":[["d","d",null],["|","_","|"],["!",null,"\'"]]}],"right":[{"ms":200,"cells":[[null,"b","b"],["|","_","|"],["!",null,"\'"]]},{"ms":200,"cells":[[null,"b","b"],["|","_","|"],["\'",null,"!"]]}]}}')},function(t){t.exports=JSON.parse('{"idle":{"right":[{"ms":[500,1000],"random":true,"cells":[[null,"_"," ",null],["(","_","_",")"]]},{"ms":[500,1000],"random":true,"cells":[[null,"-",null],["(","_",")"]]}],"left":[{"ms":[500,1000],"random":true,"cells":[[null," ","_",null],["(","_","_",")"]]},{"ms":[500,1000],"random":true,"cells":[[null,"-",null],["(","_",")"]]}]},"move":{"right":[{"ms":[500,1000],"random":true,"cells":[[null,"_"," ",null],["(","_","_",")"]]},{"ms":[500,1000],"random":true,"cells":[[null,"-",null],["(","_",")"]]}],"left":[{"ms":[500,1000],"random":true,"cells":[[null," ","_",null],["(","_","_",")"]]},{"ms":[500,1000],"random":true,"cells":[[null,"-",null],["(","_",")"]]}]},"cooldown":{"right":[{"ms":[500,1000],"random":true,"cells":[[null,"_"," ",null],["(","_","_",")"]]},{"ms":[500,1000],"random":true,"cells":[[null,"-",null],["(","_",")"]]}],"left":[{"ms":[500,1000],"random":true,"cells":[[null," ","_",null],["(","_","_",")"]]},{"ms":[500,1000],"random":true,"cells":[[null,"-",null],["(","_",")"]]}]},"attack":{"right":[{"ms":30,"cells":[[null," ","_"," ",null],["(","_","_","_",")"]]},{"ms":30,"cells":[[null,null,"-",null,null],[null,"(","_",")",null]]}],"left":[{"ms":30,"cells":[[null," ","_"," ",null],["(","_","_","_",")"]]},{"ms":30,"cells":[[null,null,"-",null,null],[null,"(","_",")",null]]}]}}')},function(t,e,n){"use strict";function s(t){let e={};e.value=t,e.isDown=!1,e.isUp=!0,e.press=void 0,e.release=void 0,e.downHandler=t=>{t.key===e.value&&(e.isUp&&e.press&&e.press(),e.isDown=!0,e.isUp=!1,t.preventDefault())},e.upHandler=t=>{t.key===e.value&&(e.isDown&&e.release&&e.release(),e.isDown=!1,e.isUp=!0,t.preventDefault())};const n=e.downHandler.bind(e),s=e.upHandler.bind(e);return window.addEventListener("keydown",n,!1),window.addEventListener("keyup",s,!1),e.unsubscribe=()=>{window.removeEventListener("keydown",n),window.removeEventListener("keyup",s)},e}n.r(e);var r=function(t,e,n){this.name=t,this.seen=e,this.is_visible=n,this.char=i[this.name]},i={wall:"#",floor:"."},o=function(){function t(){this.tiles={}}return t.prototype.setTile=function(t,e,n,s,i){this.tiles[e]||(this.tiles[e]={}),this.tiles[e][t]=new r(n,s,i)},t.prototype.updateRoom=function(t){var e=this;t.forEach((function(t){var n=t[0],s=n[0],r=n[1],i=t[1],o=t[2],l=o[0],a=o[1];e.setTile(s,r,i,l,a)}))},t}(),l=function(){function t(){this.x=0,this.y=0,this.spriteState="idle",this.direction="right"}return t.prototype.update=function(t){var e;e=t.coords,this.x=e[0],this.y=e[1],this.spriteState=t.sprite_state,this.direction=t.direction},t.prototype.tickSpriteState=function(t){this.sprite.tick(t,this.spriteState,this.direction)},t}(),a=n(0);var u,c=function(){function t(t,e,n,s,r){this.isRandom=t,this.msFrom=e,this.msTo=n,this.cells=s,this.idx=r}return t.prototype.makeCurrentFrame=function(){var t,e,n=this.msFrom;return this.isRandom&&(t=this.msFrom,e=this.msTo,n=Math.floor(Math.random()*(e-t+1)+t)),new h(n,this.cells,this.idx,0)},t}(),h=function(t,e,n,s){this.ms=t,this.cells=e,this.idx=n,this.timer=s},p=function(){function t(t){this.states={},this.load(t),console.log("sprite states",this.states),this.currentState="idle",this.currentDirection="right",this.currentFrame=this.getCurrentStateFrames()[0].makeCurrentFrame()}return t.prototype.load=function(t){var e=this;console.log("loading sprite data",t),Object.entries(t).forEach((function(t){var n=t[0],s=t[1];e.states[n]={},Object.entries(s).forEach((function(t){var s=t[0],r=t[1];e.states[n][s]=[],r.forEach((function(t,r){var i=0,o=null;t.ms.length>1?(i=t.ms[0],o=t.ms[1]):i=t.ms,t=new c(t.random,i,o,t.cells,r),e.states[n][s].push(t)}))}))}))},t.prototype.getCurrentStateFrames=function(){return this.states[this.currentState][this.currentDirection]},t.prototype.getCells=function(){return this.currentFrame.cells},t.prototype.tick=function(t,e,n){if(!this.currentState||e!=this.currentState||n!=this.currentDirection){console.log("new state",this.currentState,this.currentDirection),this.currentState=e,this.currentDirection=n;var s=this.getCurrentStateFrames()[0];this.currentFrame=s.makeCurrentFrame()}if(this.currentFrame.timer+=t,this.currentFrame.timer>this.currentFrame.ms/1e3){var r=(this.currentFrame.idx+1)%this.getCurrentStateFrames().length;s=this.getCurrentStateFrames()[r];this.currentFrame=s.makeCurrentFrame()}},t}(),f=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(t){function e(){var e=t.call(this)||this;return e.elementClass="player",e.hitPoints=100,e.sprite=new p(a),e}return f(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e),e.hit_points<this.hitPoints&&(this.hitPoints=e.hit_points)},e}(l),d=n(1),y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),w={blob:function(t){function e(){var e=t.call(this)||this;return e.elementClass="blob",e.hitPoints=100,e.sprite=new p(d),e}return y(e,t),e}(l)};window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/30)},new(function(){function t(t,e){this.sizeX=70,this.sizeY=30,this.gameDiv=t,this.guiDiv=e,this.lines=[],this.room=new o,this.player=new m,this.otherPlayers={},this.entities={},this.socket=null,this.init(),this.initNetwork(),this.initKeys()}return t.prototype.updateStateFromNetwork=function(t){var e=this;t.data.map&&this.room.updateRoom(t.data.map),t.data.self&&this.player.update(t.data.self),t.data.players&&Object.entries(t.data.players).forEach((function(t){var n=t[0],s=t[1];e.otherPlayers[n]||(e.otherPlayers[n]=new m),e.otherPlayers[n].update(s)})),t.data.entities&&Object.entries(t.data.entities).forEach((function(t){var n=t[0],s=t[1];if(!e.entities[n]){var r=s.type;e.entities[n]=new w[r]}e.entities[n].update(s)}))},t.prototype.initNetwork=function(){var t=this;this.socket=new WebSocket("ws://0.0.0.0:8080/connect"),this.socket.onopen=function(e){t.socket.onmessage=function(e){var n=JSON.parse(e.data);switch(n.type){case"init":console.log("init package!"),t.updateStateFromNetwork(n),t.start();break;case"update":t.updateStateFromNetwork(n);break;case"remove_players":n.data.forEach((function(e){delete t.otherPlayers[e]}));break;case"remove_entities":n.data.forEach((function(e){delete t.entities[e]}));break;default:console.log("unknown package ",n)}}}},t.prototype.send=function(t,e){this.socket&&this.socket.send(JSON.stringify({type:t,data:e}))},t.prototype.initKeys=function(){var t=this,e=s("a"),n=s("w"),r=s("d"),i=s("s");e.press=function(){t.send("actions",{left:"press"})},e.release=function(){t.send("actions",{left:"release"})},n.press=function(){t.send("actions",{up:"press"})},n.release=function(){t.send("actions",{up:"release"})},r.press=function(){t.send("actions",{right:"press"})},r.release=function(){t.send("actions",{right:"release"})},i.press=function(){t.send("actions",{down:"press"})},i.release=function(){t.send("actions",{down:"release"})}},t.prototype.init=function(){this.runs=!1,this.gameObjects=[],this.fps(30)},t.prototype.fps=function(t){this.currentFps=t||this.currentFps;this.currentFps;return this.currentFps},t.prototype.start=function(){0===this.gameObjects.length&&console.warn("No gameObjects in the Game."),this.startTime=Date.now(),this.lastTick=Date.now(),this.runs=!0,this.play(),console.info("Gameloop is running")},t.prototype.clearLines=function(){this.lines=[];for(var t=0;t<this.sizeY;t++){for(var e=[],n=0;n<this.sizeX;n++){e.push('<span class="empty"> </span>')}this.lines.push(e)}},t.prototype.stop=function(){this.runs=!1,this.stopTime=Date.now(),console.info("Gameloop stopped")},t.prototype.deltaTime=function(){return.001*(Date.now()-this.lastTick)},t.prototype.drawEntity=function(t){var e=this,n=t.sprite.getCells();Object.entries(n).forEach((function(n){var s=n[0],r=n[1];Object.entries(r).forEach((function(n){var r=n[0],i=n[1];i&&e.drawWithPlayerOffset(i,t.elementClass,t.x+parseInt(r),t.y+parseInt(s))}))}))},t.prototype.drawWithPlayerOffset=function(t,e,n,s){var r=this.sizeX/2-this.player.x+n,i=this.sizeY/2-this.player.y+s;r>0&&r<this.sizeX&&i>0&&i<this.sizeY&&(this.lines[i][r]='<span class="'+e+'">'+t+"</span>")},t.prototype.drawRoom=function(){var t=this;Object.entries(this.room.tiles).forEach((function(e){var n=e[0],s=e[1];Object.entries(s).forEach((function(e){var s=e[0],r=e[1],i=r.name;r.is_visible||(i+=" mapNotVisible"),t.drawWithPlayerOffset(r.char,i,parseInt(s),parseInt(n))}))}))},t.prototype.render=function(){var t=this;this.clearLines(),this.drawRoom(),this.drawEntity(this.player),Object.entries(this.otherPlayers).forEach((function(e){e[0];var n=e[1];t.drawEntity(n)})),Object.entries(this.entities).forEach((function(e){e[0];var n=e[1];t.drawEntity(n)}));var e=[];this.lines.forEach((function(t){e.push(t.join(""))})),this.gameDiv.innerHTML=e.join("\n"),this.guiDiv.innerHTML="fps: "+this.currentFps},t.prototype.update=function(){this.render();var t=this.deltaTime();this.player.tickSpriteState(t),Object.entries(this.otherPlayers).forEach((function(e){e[0];e[1].tickSpriteState(t)})),Object.entries(this.entities).forEach((function(e){e[0];e[1].tickSpriteState(t)}))},t.prototype.play=function(){var t=this,e=function(){try{if(setTimeout((function(){window.requestAnimFrame(e)}),1e3/t.currentFps),t.update(),t.lastTick=Date.now(),!t.runs)return!1}catch(e){console.error(e.stack),t.stop()}};e()},t}())(document.getElementById("container"),document.getElementById("gui"))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2tleWJvYXJkLmpzIiwid2VicGFjazovLy8uL3NyYy9yb29tLnRzIiwid2VicGFjazovLy8uL3NyYy9lbnRpdGllcy9lbnRpdHkudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2VudGl0aWVzL3Nwcml0ZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9tYXRoLnRzIiwid2VicGFjazovLy8uL3NyYy9lbnRpdGllcy9wbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2VudGl0aWVzL3R5cGVMb29rdXAudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2VudGl0aWVzL2Jsb2IudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWVsb29wLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImtleWJvYXJkIiwiaXNEb3duIiwiaXNVcCIsInByZXNzIiwidW5kZWZpbmVkIiwicmVsZWFzZSIsImRvd25IYW5kbGVyIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVwSGFuZGxlciIsImRvd25MaXN0ZW5lciIsInVwTGlzdGVuZXIiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwidW5zdWJzY3JpYmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2VlbiIsImlzX3Zpc2libGUiLCJ0aGlzIiwiY2hhciIsIlRpbGVDaGFycyIsInRpbGVzIiwic2V0VGlsZSIsIngiLCJ5IiwiVGlsZSIsInVwZGF0ZVJvb20iLCJ1cGRhdGVEYXRhIiwiZm9yRWFjaCIsInRpbGUiLCJzcHJpdGVTdGF0ZSIsImRpcmVjdGlvbiIsInVwZGF0ZSIsInBhY2tldCIsInRpY2tTcHJpdGVTdGF0ZSIsImR0Iiwic3ByaXRlIiwidGljayIsImlzX3JhbmRvbSIsIm1zRnJvbSIsIm1zVG8iLCJjZWxscyIsImlkeCIsImlzUmFuZG9tIiwibWFrZUN1cnJlbnRGcmFtZSIsIm1pbiIsIm1heCIsIm1zIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiQ3VycmVudEZyYW1lIiwidGltZXIiLCJzcHJpdGVEYXRhIiwic3RhdGVzIiwibG9hZCIsImNvbnNvbGUiLCJsb2ciLCJjdXJyZW50U3RhdGUiLCJjdXJyZW50RGlyZWN0aW9uIiwiY3VycmVudEZyYW1lIiwiZ2V0Q3VycmVudFN0YXRlRnJhbWVzIiwiZW50cmllcyIsInN0YXRlIiwiZGlyZWN0aW9ucyIsImZyYW1lcyIsImZyYW1lIiwiaW5kZXgiLCJsZW5ndGgiLCJwdXNoIiwiZ2V0Q2VsbHMiLCJuZXh0RnJhbWVJbmRleCIsImVsZW1lbnRDbGFzcyIsImhpdFBvaW50cyIsIlNwcml0ZSIsInBsYXllciIsIkVudGl0eSIsImVudGl0eUNsYXNzZXMiLCJibG9iIiwicmVxdWVzdEFuaW1GcmFtZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm1velJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJtc1JlcXVlc3RBbmltYXRpb25GcmFtZSIsImNhbGxiYWNrIiwic2V0VGltZW91dCIsImdhbWVEaXYiLCJndWlEaXYiLCJzaXplWCIsInNpemVZIiwibGluZXMiLCJyb29tIiwiUm9vbSIsIm90aGVyUGxheWVycyIsImVudGl0aWVzIiwic29ja2V0IiwiaW5pdCIsImluaXROZXR3b3JrIiwiaW5pdEtleXMiLCJ1cGRhdGVTdGF0ZUZyb21OZXR3b3JrIiwidWlkIiwicGxheWVyRGF0YSIsImVudGl0eURhdGEiLCJlbnRpdHlDbGFzcyIsIldlYlNvY2tldCIsIm9ub3BlbiIsIm9ubWVzc2FnZSIsIkpTT04iLCJwYXJzZSIsImRhdGEiLCJ0eXBlIiwic3RhcnQiLCJzZW5kIiwic3RyaW5naWZ5IiwibGVmdCIsInVwIiwicmlnaHQiLCJkb3duIiwicnVucyIsImdhbWVPYmplY3RzIiwiZnBzIiwiX2ZwcyIsImN1cnJlbnRGcHMiLCJ3YXJuIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImxhc3RUaWNrIiwicGxheSIsImluZm8iLCJjbGVhckxpbmVzIiwibGluZSIsInN0b3AiLCJzdG9wVGltZSIsImRlbHRhVGltZSIsImRyYXdFbnRpdHkiLCJlbnRpdHkiLCJ5SW5kZXgiLCJyb3ciLCJ4SW5kZXgiLCJkcmF3V2l0aFBsYXllck9mZnNldCIsInBhcnNlSW50IiwiYWJzb2x1dGVYIiwiYWJzb2x1dGVZIiwiZHJhd1Jvb20iLCJyZW5kZXIiLCJvdGhlclBsYXllciIsImxpbmVzVG9EcmF3Iiwiam9pbiIsImlubmVySFRNTCIsInNlbGYiLCJuZXh0VGltZW91dCIsImUiLCJlcnJvciIsInN0YWNrIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9C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QUFLdUgsRUFBQSxLQUM3QyxFQUFLWCxXQUFXVyxNQUVwQnpLLE9BQU9vRixRQUFRNUMsS0FBSzZFLFVBQVVuRSxTQUFRLFNBQUMsR0FBQyxLLElBQUs2RyxFQUFBLEtBQ3pDLEVBQUtELFdBQVdDLE1BR3BCLElBQU1XLEVBQTZCLEdBQ25DbEksS0FBS3lFLE1BQU0vRCxTQUFRLFNBQUF3RyxHQUNmZ0IsRUFBWS9FLEtBQUsrRCxFQUFLaUIsS0FBSyxRQUUvQm5JLEtBQUtxRSxRQUFRK0QsVUFBWUYsRUFBWUMsS0FBSyxNQUUxQ25JLEtBQUtzRSxPQUFPOEQsVUFBWSxRQUFVcEksS0FBS3lHLFlBUzNDLFlBQUEzRixPQUFBLFdBQ0lkLEtBQUtnSSxTQUVMLElBQU0vRyxFQUFLakIsS0FBS3FILFlBRWhCckgsS0FBS3lELE9BQU96QyxnQkFBZ0JDLEdBRTVCekQsT0FBT29GLFFBQVE1QyxLQUFLNEUsY0FBY2xFLFNBQVEsU0FBQyxHQUFDLEtBQUssS0FDakNNLGdCQUFnQkMsTUFHaEN6RCxPQUFPb0YsUUFBUTVDLEtBQUs2RSxVQUFVbkUsU0FBUSxTQUFDLEdBQUMsS0FBSyxLQUNsQ00sZ0JBQWdCQyxPQUsvQixZQUFBOEYsS0FBQSxXQUNJLElBQUlzQixFQUFPckksS0FDUHNJLEVBQWMsV0FDZCxJQVFJLEdBUEFsRSxZQUFXLFdBQ0QxRSxPQUFRbUUsaUJBQWlCeUUsS0FDaEMsSUFBT0QsRUFBSzVCLFlBRWY0QixFQUFLdkgsU0FDTHVILEVBQUt2QixTQUFXRixLQUFLQyxPQUVoQndCLEVBQUtoQyxLQUNOLE9BQU8sRUFFYixNQUFPa0MsR0FDTGpHLFFBQVFrRyxNQUFNRCxFQUFFRSxPQUNoQkosRUFBS2xCLFNBSWJtQixLQUVSLEVBcFRBLEdDckJlLENBQ1BJLFNBQVNDLGVBQWUsYUFDeEJELFNBQVNDLGVBQWUiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDIpO1xuIiwiLy8gc3RvbGVuIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2tpdHR5a2F0YXR0YWNrL2xlYXJuaW5nUGl4aSNrZXlib2FyZFxuXG5cbmV4cG9ydCBmdW5jdGlvbiBrZXlib2FyZCh2YWx1ZSkge1xuICBsZXQga2V5ID0ge307XG4gIGtleS52YWx1ZSA9IHZhbHVlO1xuICBrZXkuaXNEb3duID0gZmFsc2U7XG4gIGtleS5pc1VwID0gdHJ1ZTtcbiAga2V5LnByZXNzID0gdW5kZWZpbmVkO1xuICBrZXkucmVsZWFzZSA9IHVuZGVmaW5lZDtcbiAgLy9UaGUgYGRvd25IYW5kbGVyYFxuICBrZXkuZG93bkhhbmRsZXIgPSBldmVudCA9PiB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0ga2V5LnZhbHVlKSB7XG4gICAgICBpZiAoa2V5LmlzVXAgJiYga2V5LnByZXNzKSBrZXkucHJlc3MoKTtcbiAgICAgIGtleS5pc0Rvd24gPSB0cnVlO1xuICAgICAga2V5LmlzVXAgPSBmYWxzZTtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9O1xuXG4gIC8vVGhlIGB1cEhhbmRsZXJgXG4gIGtleS51cEhhbmRsZXIgPSBldmVudCA9PiB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0ga2V5LnZhbHVlKSB7XG4gICAgICBpZiAoa2V5LmlzRG93biAmJiBrZXkucmVsZWFzZSkga2V5LnJlbGVhc2UoKTtcbiAgICAgIGtleS5pc0Rvd24gPSBmYWxzZTtcbiAgICAgIGtleS5pc1VwID0gdHJ1ZTtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9O1xuXG4gIC8vQXR0YWNoIGV2ZW50IGxpc3RlbmVyc1xuICBjb25zdCBkb3duTGlzdGVuZXIgPSBrZXkuZG93bkhhbmRsZXIuYmluZChrZXkpO1xuICBjb25zdCB1cExpc3RlbmVyID0ga2V5LnVwSGFuZGxlci5iaW5kKGtleSk7XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgXCJrZXlkb3duXCIsIGRvd25MaXN0ZW5lciwgZmFsc2VcbiAgKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgXCJrZXl1cFwiLCB1cExpc3RlbmVyLCBmYWxzZVxuICApO1xuXG4gIC8vIERldGFjaCBldmVudCBsaXN0ZW5lcnNcbiAga2V5LnVuc3Vic2NyaWJlID0gKCkgPT4ge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBkb3duTGlzdGVuZXIpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdXBMaXN0ZW5lcik7XG4gIH07XG5cbiAgcmV0dXJuIGtleTtcbn0iLCJjbGFzcyBUaWxlIHtcbiAgICBuYW1lOiBzdHJpbmdcbiAgICBzZWVuOiBib29sZWFuXG4gICAgaXNfdmlzaWJsZTogYm9vbGVhblxuICAgIGNoYXI6IHN0cmluZ1xuXG4gICAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCBzZWVuOiBib29sZWFuLCBpc192aXNpYmxlOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWVcbiAgICAgICAgdGhpcy5zZWVuID0gc2VlblxuICAgICAgICB0aGlzLmlzX3Zpc2libGUgPSBpc192aXNpYmxlXG4gICAgICAgIHRoaXMuY2hhciA9IFRpbGVDaGFyc1t0aGlzLm5hbWVdXG4gICAgfVxufVxuXG5jb25zdCBUaWxlQ2hhcnM6IHsgW2luZGV4OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcbiAgICAnd2FsbCc6ICcjJyxcbiAgICAnZmxvb3InOiAnLidcbn1cblxuZXhwb3J0IGNsYXNzIFJvb20ge1xuICAgIC8vIHRpbGVzW3ldW3hdOiB0aWxlXG4gICAgdGlsZXM6IHsgW2lkOiBzdHJpbmddOiB7IFtpZDogc3RyaW5nXTogVGlsZSB9IH1cblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnRpbGVzID0ge31cbiAgICB9XG5cbiAgICBzZXRUaWxlKHg6IG51bWJlciwgeTogbnVtYmVyLCBuYW1lOiBzdHJpbmcsIHNlZW46IGJvb2xlYW4sIGlzX3Zpc2libGU6IGJvb2xlYW4pIHtcbiAgICAgICAgaWYgKCF0aGlzLnRpbGVzW3ldKSB7XG4gICAgICAgICAgICB0aGlzLnRpbGVzW3ldID0ge31cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRpbGVzW3ldW3hdID0gbmV3IFRpbGUobmFtZSwgc2VlbiwgaXNfdmlzaWJsZSlcbiAgICB9XG5cbiAgICB1cGRhdGVSb29tKHVwZGF0ZURhdGE6IEFycmF5PGFueT4pIHtcbiAgICAgICAgdXBkYXRlRGF0YS5mb3JFYWNoKCh0aWxlOiBhbnkpID0+IHtcbiAgICAgICAgICAgIGxldCBbeCwgeV0gPSB0aWxlWzBdXG4gICAgICAgICAgICBsZXQgbmFtZSA9IHRpbGVbMV1cbiAgICAgICAgICAgIGxldCBbc2VlbiwgaXNfdmlzaWJsZV0gPSB0aWxlWzJdXG4gICAgICAgICAgICB0aGlzLnNldFRpbGUoeCwgeSwgbmFtZSwgc2VlbiwgaXNfdmlzaWJsZSlcbiAgICAgICAgfSlcbiAgICB9XG59IiwiaW1wb3J0IHtyYW5kb21JbnRGcm9tSW50ZXJ2YWx9IGZyb20gXCIuLi91dGlsL21hdGhcIjtcbmltcG9ydCB7U3ByaXRlfSBmcm9tIFwiLi9zcHJpdGVcIjtcblxuXG5cbmV4cG9ydCBjbGFzcyBFbnRpdHkge1xuICAgIHNwcml0ZTogU3ByaXRlXG4gICAgeDogbnVtYmVyXG4gICAgeTogbnVtYmVyXG4gICAgXG4gICAgc3ByaXRlU3RhdGU6IHN0cmluZ1xuICAgIGRpcmVjdGlvbjogc3RyaW5nXG4gICAgXG4gICAgZWxlbWVudENsYXNzOiBzdHJpbmdcblxuICAgIGhpdFBvaW50czogbnVtYmVyXG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy54ID0gMFxuICAgICAgICB0aGlzLnkgPSAwXG4gICAgICAgIHRoaXMuc3ByaXRlU3RhdGUgPSAnaWRsZSdcbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSAncmlnaHQnXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYXBwbHkgc3RhdGUgdXBkYXRlIGZyb20gbmV0d29ya1xuICAgICAqIFxuICAgICAqIEBwYXJhbSBwYWNrZXRcbiAgICAgKi9cbiAgICB1cGRhdGUocGFja2V0OiBhbnkpIHtcbiAgICAgICAgW3RoaXMueCwgdGhpcy55XSA9IHBhY2tldFsnY29vcmRzJ11cbiAgICAgICAgdGhpcy5zcHJpdGVTdGF0ZSA9IHBhY2tldFsnc3ByaXRlX3N0YXRlJ11cbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBwYWNrZXRbJ2RpcmVjdGlvbiddXG4gICAgICAgIC8vdGhpcy5jb2xvciA9IHBhY2tldFsnY29sb3InXVxuICAgICAgICAvL3RoaXMuc3ByaXRlX3N0YXRlID0gdXBkYXRlX2RhdGFbJ3Nwcml0ZV9zdGF0ZSddXG4gICAgfVxuICAgIFxuICAgIHRpY2tTcHJpdGVTdGF0ZShkdDogbnVtYmVyKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCd0aWNraW5nIHNwcml0ZSAnLCBkdClcbiAgICAgICAgdGhpcy5zcHJpdGUudGljayhkdCwgdGhpcy5zcHJpdGVTdGF0ZSwgdGhpcy5kaXJlY3Rpb24pXG4gICAgfVxufSIsImltcG9ydCB7cmFuZG9tSW50RnJvbUludGVydmFsfSBmcm9tIFwiLi4vdXRpbC9tYXRoXCI7XG5cbmNsYXNzIEZyYW1lIHtcbiAgICBpc1JhbmRvbTogYm9vbGVhblxuICAgIG1zRnJvbTogbnVtYmVyXG4gICAgbXNUbzogbnVtYmVyXG4gICAgY2VsbHM6IEFycmF5PEFycmF5PHN0cmluZz4+XG4gICAgaWR4OiBudW1iZXJcblxuICAgIGNvbnN0cnVjdG9yKGlzX3JhbmRvbTogYm9vbGVhbixcbiAgICAgICAgICAgICAgICBtc0Zyb206IG51bWJlcixcbiAgICAgICAgICAgICAgICBtc1RvOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgY2VsbHM6IEFycmF5PEFycmF5PHN0cmluZz4+LFxuICAgICAgICAgICAgICAgIGlkeDogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuaXNSYW5kb20gPSBpc19yYW5kb21cblxuICAgICAgICB0aGlzLm1zRnJvbSA9IG1zRnJvbVxuICAgICAgICB0aGlzLm1zVG8gPSBtc1RvXG4gICAgICAgIHRoaXMuY2VsbHMgPSBjZWxsc1xuICAgICAgICB0aGlzLmlkeCA9IGlkeFxuICAgIH1cblxuICAgIG1ha2VDdXJyZW50RnJhbWUoKSB7XG4gICAgICAgIGxldCBtcyA9IHRoaXMubXNGcm9tXG4gICAgICAgIGlmICh0aGlzLmlzUmFuZG9tKSB7XG4gICAgICAgICAgICBtcyA9IHJhbmRvbUludEZyb21JbnRlcnZhbCh0aGlzLm1zRnJvbSwgdGhpcy5tc1RvKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgQ3VycmVudEZyYW1lKG1zLCB0aGlzLmNlbGxzLCB0aGlzLmlkeCwgMClcbiAgICB9XG59XG5cbmNsYXNzIEN1cnJlbnRGcmFtZSB7XG4gICAgbXM6IG51bWJlclxuICAgIGNlbGxzOiBBcnJheTxBcnJheTxzdHJpbmc+PlxuICAgIGlkeDogbnVtYmVyXG4gICAgdGltZXI6IG51bWJlclxuXG4gICAgY29uc3RydWN0b3IobXM6IG51bWJlcixcbiAgICAgICAgICAgICAgICBjZWxsczogQXJyYXk8QXJyYXk8c3RyaW5nPj4sXG4gICAgICAgICAgICAgICAgaWR4OiBudW1iZXIsXG4gICAgICAgICAgICAgICAgdGltZXI6IG51bWJlcikge1xuICAgICAgICB0aGlzLm1zID0gbXNcbiAgICAgICAgdGhpcy5jZWxscyA9IGNlbGxzXG4gICAgICAgIHRoaXMuaWR4ID0gaWR4XG4gICAgICAgIHRoaXMudGltZXIgPSB0aW1lclxuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFNwcml0ZSB7XG4gICAgc3RhdGVzOiBhbnlcbiAgICBjdXJyZW50U3RhdGU6IHN0cmluZ1xuICAgIGN1cnJlbnREaXJlY3Rpb246IHN0cmluZ1xuXG4gICAgY3VycmVudEZyYW1lOiBDdXJyZW50RnJhbWVcblxuICAgIGNvbnN0cnVjdG9yKHNwcml0ZURhdGE6IGFueSkge1xuICAgICAgICB0aGlzLnN0YXRlcyA9IHt9XG4gICAgICAgIHRoaXMubG9hZChzcHJpdGVEYXRhKVxuICAgICAgICBjb25zb2xlLmxvZygnc3ByaXRlIHN0YXRlcycsIHRoaXMuc3RhdGVzKVxuICAgICAgICB0aGlzLmN1cnJlbnRTdGF0ZSA9ICdpZGxlJ1xuICAgICAgICB0aGlzLmN1cnJlbnREaXJlY3Rpb24gPSAncmlnaHQnXG4gICAgICAgIHRoaXMuY3VycmVudEZyYW1lID0gdGhpcy5nZXRDdXJyZW50U3RhdGVGcmFtZXMoKVswXS5tYWtlQ3VycmVudEZyYW1lKClcblxuICAgIH1cblxuICAgIGxvYWQoc3ByaXRlRGF0YTogYW55KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdsb2FkaW5nIHNwcml0ZSBkYXRhJywgc3ByaXRlRGF0YSlcbiAgICAgICAgT2JqZWN0LmVudHJpZXMoc3ByaXRlRGF0YSkuZm9yRWFjaCgoW3N0YXRlLCBkaXJlY3Rpb25zXSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZXNbc3RhdGVdID0ge31cbiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKGRpcmVjdGlvbnMpLmZvckVhY2goKFtkaXJlY3Rpb24sIGZyYW1lc10pID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlc1tzdGF0ZV1bZGlyZWN0aW9uXSA9IFtdXG4gICAgICAgICAgICAgICAgZnJhbWVzLmZvckVhY2goKGZyYW1lOiBhbnksIGluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgIC0gbXM6IFs1MDAsIDEwMDBdXG4gICAgICAgICAgICAgICAgICAgICAgICByYW5kb206IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBbIH4gLCBcIl9cIiwgXCIgXCIsICB+IF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBbXCIoXCIsIFwiX1wiLCBcIl9cIiwgXCIpXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGxldCBtc0Zyb20gPSAwXG4gICAgICAgICAgICAgICAgICAgIGxldCBtc1RvID0gbnVsbFxuICAgICAgICAgICAgICAgICAgICBpZiAoZnJhbWVbJ21zJ10ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXNGcm9tID0gZnJhbWVbJ21zJ11bMF1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1zVG8gPSBmcmFtZVsnbXMnXVsxXVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXNGcm9tID0gZnJhbWVbJ21zJ11cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmcmFtZSA9IG5ldyBGcmFtZShmcmFtZVsncmFuZG9tJ10sIG1zRnJvbSwgbXNUbywgZnJhbWVbJ2NlbGxzJ10sIGluZGV4KVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlc1tzdGF0ZV1bZGlyZWN0aW9uXS5wdXNoKGZyYW1lKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGdldEN1cnJlbnRTdGF0ZUZyYW1lcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGVzW3RoaXMuY3VycmVudFN0YXRlXVt0aGlzLmN1cnJlbnREaXJlY3Rpb25dXG4gICAgfVxuICAgIFxuICAgIGdldENlbGxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50RnJhbWUuY2VsbHNcbiAgICB9XG4gICAgXG4gICAgdGljayhkdDogbnVtYmVyLCBzdGF0ZTogc3RyaW5nLCBkaXJlY3Rpb246IHN0cmluZykge1xuICAgICAgICAvLyBpZiB3ZSBhcmUgZG9pbmcgdGhpcyBmb3IgdGhlIGZpcnN0IHRpbWUgb3Igc29tZXRoaW5nIGNoYW5nZWRcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRTdGF0ZSB8fCBzdGF0ZSAhPSB0aGlzLmN1cnJlbnRTdGF0ZSB8fCBkaXJlY3Rpb24gIT0gdGhpcy5jdXJyZW50RGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbmV3IHN0YXRlJywgdGhpcy5jdXJyZW50U3RhdGUsIHRoaXMuY3VycmVudERpcmVjdGlvbilcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFN0YXRlID0gc3RhdGVcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERpcmVjdGlvbiA9IGRpcmVjdGlvblxuICAgICAgICAgICAgbGV0IGZyYW1lID0gdGhpcy5nZXRDdXJyZW50U3RhdGVGcmFtZXMoKVswXVxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RnJhbWUgPSBmcmFtZS5tYWtlQ3VycmVudEZyYW1lKClcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRoZSBhY3R1YWwgdGlja1xuICAgICAgICB0aGlzLmN1cnJlbnRGcmFtZS50aW1lciArPSBkdFxuXG4gICAgICAgIC8vIHNldCBuZXh0IGZyYW1lLCBpZiB0aW1lciBvdmVyIG1zIGZvciB0aGlzIGZyYW1lXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRGcmFtZS50aW1lcj4gdGhpcy5jdXJyZW50RnJhbWUubXMgLyAxMDAwKSB7XG4gICAgICAgICAgICBsZXQgbmV4dEZyYW1lSW5kZXggPSAodGhpcy5jdXJyZW50RnJhbWUuaWR4ICsgMSkgJSB0aGlzLmdldEN1cnJlbnRTdGF0ZUZyYW1lcygpLmxlbmd0aFxuICAgICAgICAgICAgbGV0IGZyYW1lID0gdGhpcy5nZXRDdXJyZW50U3RhdGVGcmFtZXMoKVtuZXh0RnJhbWVJbmRleF1cbiAgICAgICAgICAgIHRoaXMuY3VycmVudEZyYW1lID0gZnJhbWUubWFrZUN1cnJlbnRGcmFtZSgpXG4gICAgICAgIH1cbiAgICB9XG5cblxufSIsImV4cG9ydCBmdW5jdGlvbiByYW5kb21JbnRGcm9tSW50ZXJ2YWwobWluOiBudW1iZXIsIG1heDogbnVtYmVyKSB7IC8vIG1pbiBhbmQgbWF4IGluY2x1ZGVkXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSArIG1pbik7XG59IiwiaW1wb3J0IHtFbnRpdHl9IGZyb20gXCIuL2VudGl0eVwiO1xuXG4vLyBAdHMtaWdub3JlXG5pbXBvcnQgcGxheWVyX3Nwcml0ZSBmcm9tICcuL3Nwcml0ZXMvcGxheWVyLnlhbWwnXG5pbXBvcnQge1Nwcml0ZX0gZnJvbSBcIi4vc3ByaXRlXCI7XG5cbmV4cG9ydCBjbGFzcyBQbGF5ZXIgZXh0ZW5kcyBFbnRpdHkge1xuICAgIHNwcml0ZTogYW55XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5lbGVtZW50Q2xhc3MgPSAncGxheWVyJ1xuICAgICAgICB0aGlzLmhpdFBvaW50cyA9IDEwMFxuICAgICAgICB0aGlzLnNwcml0ZSA9IG5ldyBTcHJpdGUocGxheWVyX3Nwcml0ZSlcbiAgICB9XG5cbiAgICB1cGRhdGUocGFja2V0OiBhbnkpIHtcbiAgICAgICAgc3VwZXIudXBkYXRlKHBhY2tldClcblxuICAgICAgICBpZiAocGFja2V0WydoaXRfcG9pbnRzJ10gPCB0aGlzLmhpdFBvaW50cykge1xuICAgICAgICAgICAgLy90aGlzLnNwcml0ZS5hZGRfY3VycmVudF9lZmZlY3QobXMgPSAxMDAsIGNvbG9yID0gMTk2KVxuICAgICAgICAgICAgdGhpcy5oaXRQb2ludHMgPSBwYWNrZXRbJ2hpdF9wb2ludHMnXVxuICAgICAgICB9XG5cbiAgICB9XG59IiwiaW1wb3J0IHtFbnRpdHl9IGZyb20gXCIuL2VudGl0eVwiO1xuaW1wb3J0IHtCbG9ifSBmcm9tIFwiLi9ibG9iXCI7XG5cbmV4cG9ydCBjb25zdCBlbnRpdHlDbGFzc2VzOiB7W3R5cGU6IHN0cmluZ106IHR5cGVvZiBFbnRpdHl9ID0ge1xuICAgICdibG9iJzogQmxvYlxufSIsImltcG9ydCB7RW50aXR5fSBmcm9tIFwiLi9lbnRpdHlcIjtcblxuLy8gQHRzLWlnbm9yZVxuaW1wb3J0IGJsb2Jfc3ByaXRlIGZyb20gXCIuL3Nwcml0ZXMvYmxvYi55YW1sXCI7XG5pbXBvcnQge1Nwcml0ZX0gZnJvbSBcIi4vc3ByaXRlXCI7XG5cblxuXG5leHBvcnQgY2xhc3MgQmxvYiBleHRlbmRzIEVudGl0eSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZWxlbWVudENsYXNzID0gJ2Jsb2InXG4gICAgICAgIHRoaXMuaGl0UG9pbnRzID0gMTAwXG4gICAgICAgIHRoaXMuc3ByaXRlID0gbmV3IFNwcml0ZShibG9iX3Nwcml0ZSlcbiAgICB9XG4gICAgXG59IiwiLy8gaHR0cHM6Ly9naXRodWIuY29tL2F4bHdhaWkvR2FtZWxvb3BKUy9ibG9iL21hc3Rlci9zcmMvZ2FtZWxvb3Bqcy5jb3JlLmpzXG5cbmltcG9ydCAqIGFzIGsgZnJvbSBcIi4va2V5Ym9hcmRcIjtcbmltcG9ydCB7Um9vbX0gZnJvbSBcIi4vcm9vbVwiO1xuaW1wb3J0IHtQbGF5ZXJ9IGZyb20gXCIuL2VudGl0aWVzL3BsYXllclwiO1xuaW1wb3J0IHtFbnRpdHl9IGZyb20gXCIuL2VudGl0aWVzL2VudGl0eVwiO1xuaW1wb3J0IHtlbnRpdHlDbGFzc2VzfSBmcm9tIFwiLi9lbnRpdGllcy90eXBlTG9va3VwXCI7XG5cbig8YW55PndpbmRvdykucmVxdWVzdEFuaW1GcmFtZSA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICByZXR1cm4gKFxuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICAgIHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgICAgICAgKDxhbnk+d2luZG93KS5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgICAgICAgKDxhbnk+d2luZG93KS5vUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICAgICg8YW55PndpbmRvdykubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcblxuICAgICAgICAvLyBGYWxsYmFja1xuICAgICAgICBmdW5jdGlvbiAoY2FsbGJhY2s6IGFueSkge1xuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDAgLyAzMCk7XG4gICAgICAgIH1cblxuICAgICk7XG5cbn0oKSk7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUxvb3Age1xuICAgIGdhbWVEaXY6IGFueVxuICAgIGd1aURpdjogYW55XG4gICAgcnVuczogYm9vbGVhblxuICAgIGdhbWVPYmplY3RzOiBBcnJheTxhbnk+XG5cbiAgICBjdXJyZW50RnBzOiBudW1iZXJcbiAgICBzdGFydFRpbWU6IG51bWJlclxuICAgIGxhc3RUaWNrOiBudW1iZXJcbiAgICBzdG9wVGltZTogbnVtYmVyXG5cbiAgICBzaXplWDogbnVtYmVyXG4gICAgc2l6ZVk6IG51bWJlclxuXG4gICAgbGluZXM6IEFycmF5PEFycmF5PHN0cmluZz4+XG5cbiAgICBzb2NrZXQ6IFdlYlNvY2tldFxuXG4gICAgcm9vbTogUm9vbVxuXG4gICAgcGxheWVyOiBQbGF5ZXJcbiAgICBvdGhlclBsYXllcnM6IHsgW3VpZDogc3RyaW5nXTogUGxheWVyIH1cbiAgICBlbnRpdGllczogeyBbdWlkOiBzdHJpbmddOiBFbnRpdHkgfVxuXG4gICAgY29uc3RydWN0b3IoZ2FtZURpdjogYW55LCBndWlEaXY6IGFueSkge1xuICAgICAgICB0aGlzLnNpemVYID0gNzBcbiAgICAgICAgdGhpcy5zaXplWSA9IDMwXG5cbiAgICAgICAgdGhpcy5nYW1lRGl2ID0gZ2FtZURpdlxuICAgICAgICB0aGlzLmd1aURpdiA9IGd1aURpdlxuXG4gICAgICAgIHRoaXMubGluZXMgPSBbXVxuXG4gICAgICAgIHRoaXMucm9vbSA9IG5ldyBSb29tKClcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKClcbiAgICAgICAgdGhpcy5vdGhlclBsYXllcnMgPSB7fVxuICAgICAgICB0aGlzLmVudGl0aWVzID0ge31cblxuICAgICAgICB0aGlzLnNvY2tldCA9IG51bGxcblxuICAgICAgICB0aGlzLmluaXQoKVxuICAgICAgICB0aGlzLmluaXROZXR3b3JrKClcbiAgICAgICAgdGhpcy5pbml0S2V5cygpXG4gICAgfVxuXG4gICAgdXBkYXRlU3RhdGVGcm9tTmV0d29yayhwYWNrZXQ6IGFueSkge1xuICAgICAgICBpZiAocGFja2V0WydkYXRhJ11bJ21hcCddKSB7XG4gICAgICAgICAgICB0aGlzLnJvb20udXBkYXRlUm9vbShwYWNrZXRbJ2RhdGEnXVsnbWFwJ10pXG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFja2V0WydkYXRhJ11bJ3NlbGYnXSkge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIudXBkYXRlKHBhY2tldFsnZGF0YSddWydzZWxmJ10pXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhY2tldFsnZGF0YSddWydwbGF5ZXJzJ10pIHtcbiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHBhY2tldFsnZGF0YSddWydwbGF5ZXJzJ10pLmZvckVhY2goKFt1aWQsIHBsYXllckRhdGFdKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLm90aGVyUGxheWVyc1t1aWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3RoZXJQbGF5ZXJzW3VpZF0gPSBuZXcgUGxheWVyKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5vdGhlclBsYXllcnNbdWlkXS51cGRhdGUocGxheWVyRGF0YSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhY2tldFsnZGF0YSddWydlbnRpdGllcyddKSB7XG4gICAgICAgICAgICBPYmplY3QuZW50cmllcyhwYWNrZXRbJ2RhdGEnXVsnZW50aXRpZXMnXSkuZm9yRWFjaCgoW3VpZCwgZW50aXR5RGF0YV0pID0+IHtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5lbnRpdGllc1t1aWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBlbnRpdHlDbGFzcyA9ICg8YW55PmVudGl0eURhdGEpWyd0eXBlJ11cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbnRpdGllc1t1aWRdID0gbmV3IGVudGl0eUNsYXNzZXNbZW50aXR5Q2xhc3NdKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5lbnRpdGllc1t1aWRdLnVwZGF0ZShlbnRpdHlEYXRhKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGluaXROZXR3b3JrKCkge1xuICAgICAgICB0aGlzLnNvY2tldCA9IG5ldyBXZWJTb2NrZXQoXCJ3czovLzAuMC4wLjA6ODA4MC9jb25uZWN0XCIpO1xuICAgICAgICB0aGlzLnNvY2tldC5vbm9wZW4gPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2Nvbm5lY3RlZCEnLCBldmVudClcbiAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9ubWVzc2FnZSA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBwYWNrZXQgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpXG4gICAgICAgICAgICAgICAgc3dpdGNoIChwYWNrZXQudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdpbml0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpbml0IHBhY2thZ2UhJylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGVGcm9tTmV0d29yayhwYWNrZXQpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0KClcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0ZUZyb21OZXR3b3JrKHBhY2tldClcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlbW92ZV9wbGF5ZXJzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhY2tldFsnZGF0YSddLmZvckVhY2goKHVpZDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMub3RoZXJQbGF5ZXJzW3VpZF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVtb3ZlX2VudGl0aWVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhY2tldFsnZGF0YSddLmZvckVhY2goKHVpZDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZW50aXRpZXNbdWlkXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Vua25vd24gcGFja2FnZSAnLCBwYWNrZXQpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZW5kKHR5cGU6IHN0cmluZywgZGF0YTogYW55KSB7XG4gICAgICAgIGlmICh0aGlzLnNvY2tldCkge1xuICAgICAgICAgICAgdGhpcy5zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7dHlwZTogdHlwZSwgZGF0YTogZGF0YX0pKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW5pdEtleXMoKSB7XG4gICAgICAgIGxldCBsZWZ0ID0gay5rZXlib2FyZChcImFcIiksXG4gICAgICAgICAgICB1cCA9IGsua2V5Ym9hcmQoXCJ3XCIpLFxuICAgICAgICAgICAgcmlnaHQgPSBrLmtleWJvYXJkKFwiZFwiKSxcbiAgICAgICAgICAgIGRvd24gPSBrLmtleWJvYXJkKFwic1wiKTtcblxuICAgICAgICBsZWZ0LnByZXNzID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZW5kKCdhY3Rpb25zJywgeydsZWZ0JzogJ3ByZXNzJ30pXG4gICAgICAgIH07XG4gICAgICAgIGxlZnQucmVsZWFzZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VuZCgnYWN0aW9ucycsIHsnbGVmdCc6ICdyZWxlYXNlJ30pXG4gICAgICAgIH07XG5cbiAgICAgICAgdXAucHJlc3MgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNlbmQoJ2FjdGlvbnMnLCB7J3VwJzogJ3ByZXNzJ30pXG4gICAgICAgIH07XG4gICAgICAgIHVwLnJlbGVhc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNlbmQoJ2FjdGlvbnMnLCB7J3VwJzogJ3JlbGVhc2UnfSlcbiAgICAgICAgfTtcblxuICAgICAgICByaWdodC5wcmVzcyA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VuZCgnYWN0aW9ucycsIHsncmlnaHQnOiAncHJlc3MnfSlcbiAgICAgICAgfTtcbiAgICAgICAgcmlnaHQucmVsZWFzZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VuZCgnYWN0aW9ucycsIHsncmlnaHQnOiAncmVsZWFzZSd9KVxuICAgICAgICB9O1xuXG4gICAgICAgIGRvd24ucHJlc3MgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNlbmQoJ2FjdGlvbnMnLCB7J2Rvd24nOiAncHJlc3MnfSlcbiAgICAgICAgfTtcbiAgICAgICAgZG93bi5yZWxlYXNlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZW5kKCdhY3Rpb25zJywgeydkb3duJzogJ3JlbGVhc2UnfSlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBpbml0KCkge1xuICAgICAgICB0aGlzLnJ1bnMgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5nYW1lT2JqZWN0cyA9IFtdO1xuICAgICAgICB0aGlzLmZwcygzMCk7XG5cbiAgICB9O1xuXG5cbiAgICAvKiBAZGVzYyBnZXR0ZXIgYW5kIHNldHRlciBmb3IgZnBzXG4gICAgICogQHBhcmFtIF9mcHMgLSBpZiBkZWZpbmVkIGZwcyB3aWxsIGJlIHNldCB0byBpdHMgdmFsdWVcbiAgICAgKiBAcmV0dXJuIGN1cnJlbnQgZnBzXG4gICAgICovXG4gICAgZnBzKF9mcHM6IG51bWJlcikge1xuICAgICAgICB0aGlzLmN1cnJlbnRGcHMgPSAoX2ZwcyB8fCB0aGlzLmN1cnJlbnRGcHMpO1xuICAgICAgICBsZXQgc2tpcFRpY2tzID0gMTAwMCAvIHRoaXMuY3VycmVudEZwcztcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudEZwcztcbiAgICB9O1xuXG4gICAgc3RhcnQoKSB7XG4gICAgICAgIGlmICh0aGlzLmdhbWVPYmplY3RzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdObyBnYW1lT2JqZWN0cyBpbiB0aGUgR2FtZS4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgdGhpcy5sYXN0VGljayA9IERhdGUubm93KCk7XG4gICAgICAgIHRoaXMucnVucyA9IHRydWU7XG4gICAgICAgIHRoaXMucGxheSgpO1xuXG4gICAgICAgIGNvbnNvbGUuaW5mbygnR2FtZWxvb3AgaXMgcnVubmluZycpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNsZWFyTGluZXMoKSB7XG4gICAgICAgIHRoaXMubGluZXMgPSBbXVxuICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHRoaXMuc2l6ZVk7IHkrKykge1xuICAgICAgICAgICAgY29uc3QgbGluZSA9IFtdXG4gICAgICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMuc2l6ZVg7IHgrKykge1xuICAgICAgICAgICAgICAgIGxldCBzID0gYDxzcGFuIGNsYXNzPVwiZW1wdHlcIj4gPC9zcGFuPmBcbiAgICAgICAgICAgICAgICBsaW5lLnB1c2gocylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubGluZXMucHVzaChsaW5lKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5ydW5zID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3RvcFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgIGNvbnNvbGUuaW5mbygnR2FtZWxvb3Agc3RvcHBlZCcpO1xuXG4gICAgfTtcblxuICAgIGRlbHRhVGltZSgpIHtcbiAgICAgICAgcmV0dXJuIDAuMDAxICogKERhdGUubm93KCkgLSB0aGlzLmxhc3RUaWNrKTtcbiAgICB9XG5cblxuICAgIHByaXZhdGUgZHJhd0VudGl0eShlbnRpdHk6IEVudGl0eSkge1xuICAgICAgICBsZXQgY2VsbHMgPSBlbnRpdHkuc3ByaXRlLmdldENlbGxzKClcblxuICAgICAgICBPYmplY3QuZW50cmllcyhjZWxscykuZm9yRWFjaCgoW3lJbmRleCwgcm93XSkgPT4ge1xuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMocm93KS5mb3JFYWNoKChbeEluZGV4LCBjaGFyXSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjaGFyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhd1dpdGhQbGF5ZXJPZmZzZXQoY2hhciwgZW50aXR5LmVsZW1lbnRDbGFzcywgZW50aXR5LnggKyBwYXJzZUludCh4SW5kZXgpLCBlbnRpdHkueSArIHBhcnNlSW50KHlJbmRleCkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGRyYXdXaXRoUGxheWVyT2Zmc2V0KGNoYXI6IHN0cmluZywgZWxlbWVudENsYXNzOiBzdHJpbmcsIHg6IG51bWJlciwgeTogbnVtYmVyKSB7XG4gICAgICAgIGxldCBjZW50cmVfeCA9ICh0aGlzLnNpemVYIC8gMikgLSB0aGlzLnBsYXllci54XG4gICAgICAgIGxldCBjZW50cmVfeSA9ICh0aGlzLnNpemVZIC8gMikgLSB0aGlzLnBsYXllci55XG5cbiAgICAgICAgbGV0IGFic29sdXRlWCA9IGNlbnRyZV94ICsgeFxuICAgICAgICBsZXQgYWJzb2x1dGVZID0gY2VudHJlX3kgKyB5XG4gICAgICAgIGlmIChhYnNvbHV0ZVggPiAwICYmIGFic29sdXRlWCA8IHRoaXMuc2l6ZVhcbiAgICAgICAgICAgICYmIGFic29sdXRlWSA+IDAgJiYgYWJzb2x1dGVZIDwgdGhpcy5zaXplWSkge1xuICAgICAgICAgICAgdGhpcy5saW5lc1thYnNvbHV0ZVldW2Fic29sdXRlWF0gPSBgPHNwYW4gY2xhc3M9XCIke2VsZW1lbnRDbGFzc31cIj4ke2NoYXJ9PC9zcGFuPmBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRyYXdSb29tKCkge1xuICAgICAgICBPYmplY3QuZW50cmllcyh0aGlzLnJvb20udGlsZXMpLmZvckVhY2goKFt5SW5kZXgsIHJvd10pID0+IHtcbiAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyhyb3cpLmZvckVhY2goKFt4SW5kZXgsIHRpbGVdKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBlbGVtZW50Q2xhc3MgPSB0aWxlLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aWxlLmlzX3Zpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRDbGFzcyArPSAnIG1hcE5vdFZpc2libGUnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3V2l0aFBsYXllck9mZnNldCh0aWxlLmNoYXIsIGVsZW1lbnRDbGFzcywgcGFyc2VJbnQoeEluZGV4KSwgcGFyc2VJbnQoeUluZGV4KSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICB0aGlzLmNsZWFyTGluZXMoKVxuXG4gICAgICAgIHRoaXMuZHJhd1Jvb20oKVxuICAgICAgICB0aGlzLmRyYXdFbnRpdHkodGhpcy5wbGF5ZXIpXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKHRoaXMub3RoZXJQbGF5ZXJzKS5mb3JFYWNoKChbdWlkLCBvdGhlclBsYXllcl0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuZHJhd0VudGl0eShvdGhlclBsYXllcilcbiAgICAgICAgfSlcbiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5lbnRpdGllcykuZm9yRWFjaCgoW3VpZCwgZW50aXR5XSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kcmF3RW50aXR5KGVudGl0eSlcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBsaW5lc1RvRHJhdzogQXJyYXk8c3RyaW5nPiA9IFtdXG4gICAgICAgIHRoaXMubGluZXMuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgIGxpbmVzVG9EcmF3LnB1c2gobGluZS5qb2luKCcnKSlcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5nYW1lRGl2LmlubmVySFRNTCA9IGxpbmVzVG9EcmF3LmpvaW4oJ1xcbicpXG5cbiAgICAgICAgdGhpcy5ndWlEaXYuaW5uZXJIVE1MID0gJ2ZwczogJyArIHRoaXMuY3VycmVudEZwc1xuICAgICAgICAvKlxuICAgICAgICBmb3IgKGxldCByZW5kZXJJID0gMDsgcmVuZGVySSA8IGdhbWVPYmplY3RzLmxlbmd0aDsgcmVuZGVySSsrKSB7XG4gICAgICAgICAgICB0aGlzLmdhbWVPYmplY3RzW3JlbmRlckldLmRyYXcoKTtcbiAgICAgICAgfVxuICAgICAgICAqL1xuXG4gICAgfVxuXG4gICAgdXBkYXRlKCkge1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuXG4gICAgICAgIGNvbnN0IGR0ID0gdGhpcy5kZWx0YVRpbWUoKVxuXG4gICAgICAgIHRoaXMucGxheWVyLnRpY2tTcHJpdGVTdGF0ZShkdClcblxuICAgICAgICBPYmplY3QuZW50cmllcyh0aGlzLm90aGVyUGxheWVycykuZm9yRWFjaCgoW3VpZCwgb3RoZXJQbGF5ZXJdKSA9PiB7XG4gICAgICAgICAgICBvdGhlclBsYXllci50aWNrU3ByaXRlU3RhdGUoZHQpXG4gICAgICAgIH0pXG5cbiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5lbnRpdGllcykuZm9yRWFjaCgoW3VpZCwgZW50aXR5XSkgPT4ge1xuICAgICAgICAgICAgZW50aXR5LnRpY2tTcHJpdGVTdGF0ZShkdClcbiAgICAgICAgfSlcbiAgICB9XG5cblxuICAgIHBsYXkoKSB7XG4gICAgICAgIGxldCBzZWxmID0gdGhpc1xuICAgICAgICBsZXQgbmV4dFRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAoPGFueT53aW5kb3cpLnJlcXVlc3RBbmltRnJhbWUobmV4dFRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIH0sIDEwMDAgLyBzZWxmLmN1cnJlbnRGcHMpO1xuXG4gICAgICAgICAgICAgICAgc2VsZi51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICBzZWxmLmxhc3RUaWNrID0gRGF0ZS5ub3coKTtcblxuICAgICAgICAgICAgICAgIGlmICghc2VsZi5ydW5zKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlLnN0YWNrKVxuICAgICAgICAgICAgICAgIHNlbGYuc3RvcCgpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICBuZXh0VGltZW91dCgpXG4gICAgfVxufVxuXG4iLCJpbXBvcnQgKiBhcyBrIGZyb20gJy4va2V5Ym9hcmQnXG5pbXBvcnQgR2FtZSBmcm9tICcuL2dhbWVsb29wJ1xuXG5cbmZ1bmN0aW9uIHNldHVwKCkge1xuICAgIC8vQ2FwdHVyZSB0aGUga2V5Ym9hcmQgYXJyb3cga2V5c1xuXG5cbiAgICBsZXQgZ2FtZSA9IG5ldyBHYW1lKFxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyksXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdndWknKSk7XG59XG5cblxuc2V0dXAoKSJdLCJzb3VyY2VSb290IjoiIn0=